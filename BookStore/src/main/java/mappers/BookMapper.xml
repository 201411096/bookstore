<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="BookDAO">
   <!-- mybatis 자료형 : int / hashmap / string -->
   <select id="selectBook" resultType="book" parameterType="book">
<!--       select * from BOOK where BOOK_ID = #{bookId} -->
      SELECT b.BOOK_ID AS BOOK_ID, b.WRITER_ID AS WRITER_ID, b.BOOK_PRICE AS BOOK_PRICE, 
      b.BOOK_NAME AS BOOK_NAME, b.BOOK_GENRE AS BOOK_GENRE, b.BOOK_STORY AS BOOK_STORY, 
      b.BOOK_PDATE AS BOOK_PDATE, b.BOOK_SALEPRICE AS BOOK_SALEPRICE, b.BOOK_CNT AS BOOK_CNT, b.BOOK_SCORE AS BOOK_SCORE,
      w.WRITER_ID AS WRITER_ID, w.WRITER_NAME AS WRITER_NAME
      FROM BOOK b JOIN WRITER w 
      ON b.WRITER_ID = w.WRITER_ID
      WHERE BOOK_ID = #{bookId}
   </select>
   
   <select id="searchList" resultType="book" parameterType="hashmap">
   SELECT b.BOOK_ID AS BOOK_ID, b.WRITER_ID AS WRITER_ID, b.BOOK_PRICE AS BOOK_PRICE, 
	b.BOOK_NAME AS BOOK_NAME, b.BOOK_GENRE AS BOOK_GENRE, b.BOOK_STORY AS BOOK_STORY, 
	b.BOOK_PDATE AS BOOK_PDATE, b.BOOK_SALEPRICE AS BOOK_SALEPRICE, b.BOOK_CNT AS BOOK_CNT, b.BOOK_SCORE AS BOOK_SCORE,
	w.WRITER_ID AS WRITER_ID, w.WRITER_NAME AS WRITER_NAME
	FROM BOOK b JOIN WRITER w 
	ON b.WRITER_ID = w.WRITER_ID
	WHERE REGEXP_LIKE (BOOK_NAME, '(*)'||#{searchWord}||'(*)') OR REGEXP_LIKE (WRITER_NAME, '(*)'||#{searchWord}||'(*)')
	order by book_score desc
   </select>
</mapper>