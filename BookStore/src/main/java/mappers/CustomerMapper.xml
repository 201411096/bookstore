<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CustomerDAO">
	<!-- mybatis 자료형 : int / hashmap / string -->
<!-- 	로그인을 확인하는 부분 -->
	<select id="selectCustomer" resultType="customer" parameterType="customer">
		select * from CUSTOMER where CUSTOMER_ID = #{customerId} 
		<if test="customerPassword!=null">
			and customer_password = #{customerPassword}
		</if>
	</select>
<!-- 	장바구니 갯수를 확인하는 부분 -->
	<select id="getCartListNumber" resultType="int" parameterType="string">
		select count(*) from BUYCARTLIST where customer_id=#{customerId}
	</select>
<!-- 	장바구니안 물품의 가격합을 확인하는 부분 -->
	<select id="getCartListTotalPrice" resultType="int" parameterType="string">
		select SUM(BOOK_SALEPRICE) from book where book_id in ( select book_id from buycartlist WHERE customer_id=#{customerId} )
	</select>
	<select id="getCartList" resultType="bookcart" parameterType="string">
		select l.buycartlist_id AS buycartlist_id, b.book_id as book_id, b.book_name as book_name, l.buycartlist_cnt as buycartlist_cnt, b.book_price as book_price, (b.book_price*l.buycartlist_cnt) as book_totalprice
		from book b 
		inner join buycartlist l
		on b.book_id = l.book_id
		where customer_id=#{customerId}
	</select>
	
</mapper>